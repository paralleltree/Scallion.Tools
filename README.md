# Scallion.Tools (MikuMikuUtils)
A collection of useful tools for files generated by MikuMikuDance with Scallion

[![Build status](https://ci.appveyor.com/api/projects/status/82hvphm0h0lg7cu7?svg=true)](https://ci.appveyor.com/project/paralleltree/scallion-tools)


## コマンド一覧
各コマンドを`--help`オプションとともに実行することで、詳細を表示できます。

### vmdscale
モーションファイルをスケーリングし出力します。

使用例 (`motion.vmd`を0.8倍して`motion_x0.8.vmd`に出力)
```
vmdscale motion.vmd -s 0.8
```

### vmdcut
モーションファイルの指定の範囲を切り出して出力します。

使用例 (`motion.vmd`の100フレーム(0起点)から400フレームまでのキーフレームを`out.vmd`に出力)
```
vmdcut motion.vmd --start 100 --end 400 -o out.vmd
```

## Scallion.Tools.Essentials
[![NuGet Release](https://img.shields.io/nuget/vpre/Scallion.Tools.Essentials.svg)](https://www.nuget.org/packages/Scallion.Tools.Essentials)

バックエンドとして[Scallion](https://github.com/paralleltree/Scallion)を利用するコマンドを作成する補助ライブラリです。

### コマンド作成例

Visual Studio上でコンソールアプリケーションを新規作成します。

プロジェクトのターゲットフレームワークを`.NET Framework 4.6`以上に設定します。

パッケージマネージャーコンソールで次のコマンドを実行し、 `Scallion.Tools.Essentials` をインストールします。

```
PM> Install-Package Scallion.Tools.Essentials
```

生成された`Program.cs`を次のように書き換え、`Run()`内に処理を記述します。

```cs
using System;
using NDesk.Options;
using Scallion.DomainModels;
using Scallion.Tools.Essentials;

// Runnerクラスを継承
class Program : Runner
{
    public override string Description
    {
        get { return "コマンドの説明"; }
    }

    public override string ArgumentFormat
    {
        get { return "オプションの書式"; }
    }

    // エントリポイント
    static void Main(string[] args)
    {
        Runner.Execute(() => new Program(args)); // Runner.Executeに初期化処理を渡す
    }

    private Program(string[] args)
    {
        bool showHelp = false;
        var opt = new OptionSet()
        {
            { "?|h|help", "ヘルプを表示し、終了します。", _ =>  showHelp = _ != null }
        };

        var file = opt.Parse(args);

        if (showHelp || file.Count != 1)
        {
            PrintHelp(opt); // オプション付きヘルプを表示
            Environment.Exit(showHelp ? 0 : 1);
        }
    }

    public override void Run()
    {
        // コマンド内処理
    }
}
```
